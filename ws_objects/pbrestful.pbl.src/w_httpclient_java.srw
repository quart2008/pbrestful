$PBExportHeader$w_httpclient_java.srw
forward
global type w_httpclient_java from window
end type
type st_code from statictext within w_httpclient_java
end type
type st_text from statictext within w_httpclient_java
end type
type cb_2 from commandbutton within w_httpclient_java
end type
type tab_1 from tab within w_httpclient_java
end type
type tabpage_1 from userobject within tab_1
end type
type st_28 from statictext within tabpage_1
end type
type ddlb_1 from dropdownlistbox within tabpage_1
end type
type rb_2 from radiobutton within tabpage_1
end type
type rb_1 from radiobutton within tabpage_1
end type
type cb_17 from commandbutton within tabpage_1
end type
type cb_1 from commandbutton within tabpage_1
end type
type sle_method1 from singlelineedit within tabpage_1
end type
type st_3 from statictext within tabpage_1
end type
type sle_url1 from singlelineedit within tabpage_1
end type
type st_2 from statictext within tabpage_1
end type
type mle_1 from multilineedit within tabpage_1
end type
type tabpage_1 from userobject within tab_1
st_28 st_28
ddlb_1 ddlb_1
rb_2 rb_2
rb_1 rb_1
cb_17 cb_17
cb_1 cb_1
sle_method1 sle_method1
st_3 st_3
sle_url1 sle_url1
st_2 st_2
mle_1 mle_1
end type
type tabpage_2 from userobject within tab_1
end type
type st_19 from statictext within tabpage_2
end type
type ddlb_2 from dropdownlistbox within tabpage_2
end type
type rb_4 from radiobutton within tabpage_2
end type
type rb_3 from radiobutton within tabpage_2
end type
type cb_20 from commandbutton within tabpage_2
end type
type mle_2 from multilineedit within tabpage_2
end type
type cb_6 from commandbutton within tabpage_2
end type
type sle_method2 from singlelineedit within tabpage_2
end type
type st_5 from statictext within tabpage_2
end type
type sle_url2 from singlelineedit within tabpage_2
end type
type st_1 from statictext within tabpage_2
end type
type tabpage_2 from userobject within tab_1
st_19 st_19
ddlb_2 ddlb_2
rb_4 rb_4
rb_3 rb_3
cb_20 cb_20
mle_2 mle_2
cb_6 cb_6
sle_method2 sle_method2
st_5 st_5
sle_url2 sle_url2
st_1 st_1
end type
type tabpage_3 from userobject within tab_1
end type
type st_20 from statictext within tabpage_3
end type
type ddlb_3 from dropdownlistbox within tabpage_3
end type
type rb_6 from radiobutton within tabpage_3
end type
type rb_5 from radiobutton within tabpage_3
end type
type st_10 from statictext within tabpage_3
end type
type sle_productid from singlelineedit within tabpage_3
end type
type st_8 from statictext within tabpage_3
end type
type st_7 from statictext within tabpage_3
end type
type sle_url3 from singlelineedit within tabpage_3
end type
type sle_method3 from singlelineedit within tabpage_3
end type
type mle_3 from multilineedit within tabpage_3
end type
type cb_8 from commandbutton within tabpage_3
end type
type tabpage_3 from userobject within tab_1
st_20 st_20
ddlb_3 ddlb_3
rb_6 rb_6
rb_5 rb_5
st_10 st_10
sle_productid sle_productid
st_8 st_8
st_7 st_7
sle_url3 sle_url3
sle_method3 sle_method3
mle_3 mle_3
cb_8 cb_8
end type
type tabpage_4 from userobject within tab_1
end type
type st_26 from statictext within tabpage_4
end type
type ddlb_4 from dropdownlistbox within tabpage_4
end type
type rb_8 from radiobutton within tabpage_4
end type
type rb_7 from radiobutton within tabpage_4
end type
type sle_productid4 from multilineedit within tabpage_4
end type
type mle_4 from multilineedit within tabpage_4
end type
type cb_9 from commandbutton within tabpage_4
end type
type st_14 from statictext within tabpage_4
end type
type sle_method4 from singlelineedit within tabpage_4
end type
type st_12 from statictext within tabpage_4
end type
type st_11 from statictext within tabpage_4
end type
type sle_url4 from singlelineedit within tabpage_4
end type
type tabpage_4 from userobject within tab_1
st_26 st_26
ddlb_4 ddlb_4
rb_8 rb_8
rb_7 rb_7
sle_productid4 sle_productid4
mle_4 mle_4
cb_9 cb_9
st_14 st_14
sle_method4 sle_method4
st_12 st_12
st_11 st_11
sle_url4 sle_url4
end type
type tabpage_5 from userobject within tab_1
end type
type st_27 from statictext within tabpage_5
end type
type ddlb_5 from dropdownlistbox within tabpage_5
end type
type rb_10 from radiobutton within tabpage_5
end type
type rb_9 from radiobutton within tabpage_5
end type
type mle_5 from multilineedit within tabpage_5
end type
type cb_10 from commandbutton within tabpage_5
end type
type sle_productid5 from singlelineedit within tabpage_5
end type
type st_18 from statictext within tabpage_5
end type
type sle_method5 from singlelineedit within tabpage_5
end type
type st_16 from statictext within tabpage_5
end type
type st_15 from statictext within tabpage_5
end type
type sle_url5 from singlelineedit within tabpage_5
end type
type tabpage_5 from userobject within tab_1
st_27 st_27
ddlb_5 ddlb_5
rb_10 rb_10
rb_9 rb_9
mle_5 mle_5
cb_10 cb_10
sle_productid5 sle_productid5
st_18 st_18
sle_method5 sle_method5
st_16 st_16
st_15 st_15
sle_url5 sle_url5
end type
type tabpage_7 from userobject within tab_1
end type
type st_29 from statictext within tabpage_7
end type
type ddlb_6 from dropdownlistbox within tabpage_7
end type
type rb_12 from radiobutton within tabpage_7
end type
type rb_11 from radiobutton within tabpage_7
end type
type sle_productid7 from multilineedit within tabpage_7
end type
type mle_7 from multilineedit within tabpage_7
end type
type cb_13 from commandbutton within tabpage_7
end type
type st_9 from statictext within tabpage_7
end type
type sle_method7 from singlelineedit within tabpage_7
end type
type st_6 from statictext within tabpage_7
end type
type sle_url7 from singlelineedit within tabpage_7
end type
type st_4 from statictext within tabpage_7
end type
type tabpage_7 from userobject within tab_1
st_29 st_29
ddlb_6 ddlb_6
rb_12 rb_12
rb_11 rb_11
sle_productid7 sle_productid7
mle_7 mle_7
cb_13 cb_13
st_9 st_9
sle_method7 sle_method7
st_6 st_6
sle_url7 sle_url7
st_4 st_4
end type
type tabpage_8 from userobject within tab_1
end type
type st_31 from statictext within tabpage_8
end type
type ddlb_7 from dropdownlistbox within tabpage_8
end type
type rb_14 from radiobutton within tabpage_8
end type
type rb_13 from radiobutton within tabpage_8
end type
type cb_4 from commandbutton within tabpage_8
end type
type mle_8 from multilineedit within tabpage_8
end type
type cb_3 from commandbutton within tabpage_8
end type
type sle_productid8 from singlelineedit within tabpage_8
end type
type st_21 from statictext within tabpage_8
end type
type sle_method8 from singlelineedit within tabpage_8
end type
type st_17 from statictext within tabpage_8
end type
type sle_url8 from singlelineedit within tabpage_8
end type
type st_13 from statictext within tabpage_8
end type
type tabpage_8 from userobject within tab_1
st_31 st_31
ddlb_7 ddlb_7
rb_14 rb_14
rb_13 rb_13
cb_4 cb_4
mle_8 mle_8
cb_3 cb_3
sle_productid8 sle_productid8
st_21 st_21
sle_method8 sle_method8
st_17 st_17
sle_url8 sle_url8
st_13 st_13
end type
type tabpage_9 from userobject within tab_1
end type
type st_32 from statictext within tabpage_9
end type
type ddlb_8 from dropdownlistbox within tabpage_9
end type
type rb_16 from radiobutton within tabpage_9
end type
type rb_15 from radiobutton within tabpage_9
end type
type cb_19 from commandbutton within tabpage_9
end type
type cb_18 from commandbutton within tabpage_9
end type
type cb_14 from commandbutton within tabpage_9
end type
type cb_7 from commandbutton within tabpage_9
end type
type mle_9 from multilineedit within tabpage_9
end type
type cb_5 from commandbutton within tabpage_9
end type
type sle_method9 from singlelineedit within tabpage_9
end type
type st_23 from statictext within tabpage_9
end type
type sle_url9 from singlelineedit within tabpage_9
end type
type st_22 from statictext within tabpage_9
end type
type tabpage_9 from userobject within tab_1
st_32 st_32
ddlb_8 ddlb_8
rb_16 rb_16
rb_15 rb_15
cb_19 cb_19
cb_18 cb_18
cb_14 cb_14
cb_7 cb_7
mle_9 mle_9
cb_5 cb_5
sle_method9 sle_method9
st_23 st_23
sle_url9 sle_url9
st_22 st_22
end type
type tabpage_10 from userobject within tab_1
end type
type st_33 from statictext within tabpage_10
end type
type ddlb_9 from dropdownlistbox within tabpage_10
end type
type rb_18 from radiobutton within tabpage_10
end type
type rb_17 from radiobutton within tabpage_10
end type
type mle_10 from multilineedit within tabpage_10
end type
type cb_22 from commandbutton within tabpage_10
end type
type sle_file from singlelineedit within tabpage_10
end type
type cb_21 from commandbutton within tabpage_10
end type
type sle_filepath from singlelineedit within tabpage_10
end type
type st_30 from statictext within tabpage_10
end type
type sle_method10 from singlelineedit within tabpage_10
end type
type st_25 from statictext within tabpage_10
end type
type sle_url10 from singlelineedit within tabpage_10
end type
type st_24 from statictext within tabpage_10
end type
type tabpage_10 from userobject within tab_1
st_33 st_33
ddlb_9 ddlb_9
rb_18 rb_18
rb_17 rb_17
mle_10 mle_10
cb_22 cb_22
sle_file sle_file
cb_21 cb_21
sle_filepath sle_filepath
st_30 st_30
sle_method10 sle_method10
st_25 st_25
sle_url10 sle_url10
st_24 st_24
end type
type tab_1 from tab within w_httpclient_java
tabpage_1 tabpage_1
tabpage_2 tabpage_2
tabpage_3 tabpage_3
tabpage_4 tabpage_4
tabpage_5 tabpage_5
tabpage_7 tabpage_7
tabpage_8 tabpage_8
tabpage_9 tabpage_9
tabpage_10 tabpage_10
end type
end forward

global type w_httpclient_java from window
integer width = 3584
integer height = 1852
boolean titlebar = true
string title = "HttpClient RestFul (for Java)"
boolean controlmenu = true
boolean minbox = true
boolean maxbox = true
boolean resizable = true
long backcolor = 67108864
string icon = "AppIcon!"
boolean center = true
st_code st_code
st_text st_text
cb_2 cb_2
tab_1 tab_1
end type
global w_httpclient_java w_httpclient_java

type prototypes

end prototypes

type variables
String 	is_sign, is_value, is_ip, is_ip_https
eon_appeon_resize  ieon_resize
u_derek_fun 	iu_urlfun
end variables

forward prototypes
public function string wf_gettimestamp ()
public function string wf_getrandom ()
public subroutine of_parsejson (ref jsonparser anv_jsonparser, longptr alp_handle, string as_key)
end prototypes

public function string wf_gettimestamp ();Long 		ll_days, ll_Seconds, ll_microsecond
Double 	ll_Stamp
Date 		ld_Today
Time 		lt_Now

ld_Today = Today()
ll_days = DaysAfter ( Date(1970,1,1), ld_Today )

lt_Now = Now()
ll_Seconds = SecondsAfter ( Time ( 8,0,0 ), lt_Now )

ll_Stamp = ll_days * 24 * 60 * 60 + ll_Seconds


Return String ( ll_Stamp ) + Left ( String ( lt_now, "ffffff" ), 3 )
end function

public function string wf_getrandom ();Long 		ll_Random

ll_Random = Rand(32767)

Return String ( ll_Random )
end function

public subroutine of_parsejson (ref jsonparser anv_jsonparser, longptr alp_handle, string as_key);//of_ParseJson(JsonParser anv_JsonParser, longptr alp_Handle)

Long 	ll_ChildCount, ll_index, llp_child, llp_root
String ls_null
JsonItemType ljit_JsonItemType

ljit_JsonItemType = anv_JsonParser.GetItemType(alp_Handle)

// 根据结点类型递归或取结点的值
if ljit_JsonItemType = JsonObjectItem! or ljit_JsonItemType = JsonArrayItem! then
	// 递归结点
	ll_ChildCount = anv_JsonParser.GetChildCount(alp_Handle)
	for ll_Index = 1 to ll_ChildCount
		llp_Child = anv_JsonParser.GetChildItem(alp_Handle, ll_Index)
		string ls_key
		ls_key = anv_JsonParser.GetChildKey(alp_Handle, ll_Index)
//		If IsNull ( ls_key ) Or Trim ( ls_key ) = "" Then
//			ls_key = "none"
//		End If		
		of_ParseJson(anv_JsonParser, llp_Child,ls_key)
	next
else // 取结点的值
	choose case ljit_JsonItemType
		case JsonStringItem!
			String ls_value 
			ls_value = anv_JsonParser.GetItemString(alp_Handle)				
			is_value = is_value + as_key + ": " + ls_value + "~r~n"
		case JsonNumberItem!
			Double ldb_value
			ldb_value = anv_JsonParser.GetItemNumber(alp_Handle)
			is_value = is_value + as_key + ": " + string ( ldb_value) + "~r~n"
		case JsonBooleanItem!
			Boolean lb_value
			lb_value = anv_JsonParser.GetItemBoolean(alp_Handle)
			is_value = is_value +as_key+ ": " + string ( lb_value) + "~r~n"
		case JsonNullItem!
			//SetNull(ls_Null)			
			is_value = is_value + as_key + ": null " + "~r~n"
	end choose
end if

end subroutine

on w_httpclient_java.create
this.st_code=create st_code
this.st_text=create st_text
this.cb_2=create cb_2
this.tab_1=create tab_1
this.Control[]={this.st_code,&
this.st_text,&
this.cb_2,&
this.tab_1}
end on

on w_httpclient_java.destroy
destroy(this.st_code)
destroy(this.st_text)
destroy(this.cb_2)
destroy(this.tab_1)
end on

event open;ieon_resize = create eon_appeon_resize

ieon_resize.of_init(this,true)

tab_1.tabpage_4.sle_productid4.Text = 'id=1&purchaseOrder=ABERDE01&line=1&item=2307-004970&itemType=Consigned&itemDescription=SILICONEedit&qtyOrdered=24.0000000000&unitOfPurchase=EACH&unitCost=4.6300000000&dueDate=2007-10-12%2000%3A00%3A00.0&dateCompleted=2007-10-09%2000%3A00%3A00.0&manufacturerPartNo=14073'
tab_1.tabpage_7.sle_productid7.Text = 'id=&purchaseOrder=ABERDE01&line=1&item=2307-004970&itemType=Consigned&itemDescription=SILICONEedit2&qtyOrdered=24.0000000000&unitOfPurchase=EACH&unitCost=4.6300000000&dueDate=2007-10-12%2000%3A00%3A00.0&dateCompleted=2007-10-09%2000%3A00%3A00.0&manufacturerPartNo=14073'

is_ip =  profilestring("config.ini","settings","Restful_http_Java","")
//设置url
tab_1.tabpage_1.sle_url1.Text = is_ip + "/springRest/api/jsonTest/listForMutiFormat/1.xml"
tab_1.tabpage_2.sle_url2.Text = is_ip + "/springRest/api/jsonTest/listAll.json"
tab_1.tabpage_3.sle_url3.Text = is_ip + "/springRest/api/jsonTest/findById/"
tab_1.tabpage_4.sle_url4.Text = is_ip + "/springRest/api/jsonTest/add"
tab_1.tabpage_5.sle_url5.Text = is_ip + "/springRest/api/jsonTest/delete/"
tab_1.tabpage_7.sle_url7.Text = is_ip + "/springRest/api/jsonTest/add"
tab_1.tabpage_8.sle_url8.Text = is_ip + "/springRest/api/jsonTest/listForMutiFormat/"
tab_1.tabpage_9.sle_url9.Text = is_ip + "/springRest/api/jsonTest/testEncode"
tab_1.tabpage_10.sle_url10.Text = is_ip + "/springRest/api/fileOperate/uploadFile"


//https
is_ip_https = profilestring("config.ini","settings","Restful_https_Java","")
end event

event resize;ieon_resize.of_resize(this,newwidth,newheight,true)
end event

type st_code from statictext within w_httpclient_java
integer x = 37
integer y = 1308
integer width = 343
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 128
long backcolor = 67108864
string text = "code"
boolean focusrectangle = false
end type

type st_text from statictext within w_httpclient_java
integer x = 398
integer y = 1308
integer width = 521
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 128
long backcolor = 67108864
string text = "text"
boolean focusrectangle = false
end type

type cb_2 from commandbutton within w_httpclient_java
integer x = 1408
integer y = 1560
integer width = 448
integer height = 100
integer taborder = 80
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "test URLencode"
end type

event clicked;String 	ls_test, ls_temp

ls_test = "abcd中文"
//EncodingANSI! (default)
//EncodingUTF8!
//EncodingUTF16LE!
//EncodingUTF16BE!

ls_temp = iu_urlfun.urlencode( ls_test,EncodingUTF8!)
MessageBox ( "Tip", ls_temp )

ls_temp = iu_urlfun.urldecode( ls_test,EncodingUTF8!)
MessageBox ( "Tip", ls_temp )

end event

type tab_1 from tab within w_httpclient_java
integer x = 37
integer y = 24
integer width = 3346
integer height = 1272
integer taborder = 10
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long backcolor = 67108864
boolean raggedright = true
boolean focusonbuttondown = true
integer selectedtab = 1
tabpage_1 tabpage_1
tabpage_2 tabpage_2
tabpage_3 tabpage_3
tabpage_4 tabpage_4
tabpage_5 tabpage_5
tabpage_7 tabpage_7
tabpage_8 tabpage_8
tabpage_9 tabpage_9
tabpage_10 tabpage_10
end type

on tab_1.create
this.tabpage_1=create tabpage_1
this.tabpage_2=create tabpage_2
this.tabpage_3=create tabpage_3
this.tabpage_4=create tabpage_4
this.tabpage_5=create tabpage_5
this.tabpage_7=create tabpage_7
this.tabpage_8=create tabpage_8
this.tabpage_9=create tabpage_9
this.tabpage_10=create tabpage_10
this.Control[]={this.tabpage_1,&
this.tabpage_2,&
this.tabpage_3,&
this.tabpage_4,&
this.tabpage_5,&
this.tabpage_7,&
this.tabpage_8,&
this.tabpage_9,&
this.tabpage_10}
end on

on tab_1.destroy
destroy(this.tabpage_1)
destroy(this.tabpage_2)
destroy(this.tabpage_3)
destroy(this.tabpage_4)
destroy(this.tabpage_5)
destroy(this.tabpage_7)
destroy(this.tabpage_8)
destroy(this.tabpage_9)
destroy(this.tabpage_10)
end on

type tabpage_1 from userobject within tab_1
integer x = 18
integer y = 104
integer width = 3310
integer height = 1152
long backcolor = 67108864
string text = "GetXMLTest"
long tabtextcolor = 33554432
long picturemaskcolor = 536870912
st_28 st_28
ddlb_1 ddlb_1
rb_2 rb_2
rb_1 rb_1
cb_17 cb_17
cb_1 cb_1
sle_method1 sle_method1
st_3 st_3
sle_url1 sle_url1
st_2 st_2
mle_1 mle_1
end type

on tabpage_1.create
this.st_28=create st_28
this.ddlb_1=create ddlb_1
this.rb_2=create rb_2
this.rb_1=create rb_1
this.cb_17=create cb_17
this.cb_1=create cb_1
this.sle_method1=create sle_method1
this.st_3=create st_3
this.sle_url1=create sle_url1
this.st_2=create st_2
this.mle_1=create mle_1
this.Control[]={this.st_28,&
this.ddlb_1,&
this.rb_2,&
this.rb_1,&
this.cb_17,&
this.cb_1,&
this.sle_method1,&
this.st_3,&
this.sle_url1,&
this.st_2,&
this.mle_1}
end on

on tabpage_1.destroy
destroy(this.st_28)
destroy(this.ddlb_1)
destroy(this.rb_2)
destroy(this.rb_1)
destroy(this.cb_17)
destroy(this.cb_1)
destroy(this.sle_method1)
destroy(this.st_3)
destroy(this.sle_url1)
destroy(this.st_2)
destroy(this.mle_1)
end on

type st_28 from statictext within tabpage_1
integer x = 2528
integer y = 116
integer width = 608
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 16711680
long backcolor = 67108864
string text = "TSL1.1和TSL1.2会失败"
boolean focusrectangle = false
end type

type ddlb_1 from dropdownlistbox within tabpage_1
integer x = 2715
integer y = 16
integer width = 411
integer height = 452
integer taborder = 30
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean enabled = false
string item[] = {"default","SSL2.0","SSL3.0","TSL1.0","TSL1.1","TSL1.2"}
borderstyle borderstyle = stylelowered!
end type

event constructor;this.selectitem( 1)

end event

type rb_2 from radiobutton within tabpage_1
integer x = 2469
integer y = 20
integer width = 247
integer height = 72
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Https"
end type

event clicked;if rb_2.Checked Then
	rb_1.Checked = false
	sle_url1.Text = is_ip_https + "/springRest/api/jsonTest/listForMutiFormat/1.xml"
	ddlb_1.Enabled = true
End If
end event

type rb_1 from radiobutton within tabpage_1
integer x = 2226
integer y = 20
integer width = 238
integer height = 72
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Http"
boolean checked = true
end type

event clicked;if rb_1.Checked Then
	rb_2.Checked = false
	sle_url1.Text = is_ip + "/springRest/api/jsonTest/listForMutiFormat/1.xml"
	ddlb_1.Enabled = false
End If
end event

type cb_17 from commandbutton within tabpage_1
integer x = 421
integer y = 188
integer width = 507
integer height = 100
integer taborder = 70
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "Get XML + Header"
end type

event clicked;HttpClient 	lhc_Client
String 		ls_Url, ls_id, ls_Method, ls_Body, ls_Respose, ls_txt, ls_Error
Long 			ll_rtn, ll_Code

lhc_Client = Create HttpClient

st_code.Text = ""
st_Text.Text = ""

ls_Url = Trim ( sle_Url1.Text ) 
ls_Method = Trim ( sle_Method1.Text )

//lhc_Client.SetRequestHeader ( "Content-Type", "application/json" )
lhc_Client.SetRequestHeader ( "Content-Type", "application/xml" )

lhc_Client.TimeOut = 10
If rb_2.Checked Then
	Choose Case ddlb_1.Text
		Case "default"
			lhc_Client.secureprotocol = 0
		Case 'SSL2.0'
			lhc_Client.secureprotocol = 1
		Case 'SSL3.0'
			lhc_Client.secureprotocol = 2
		Case 'TSL1.0'
			lhc_Client.secureprotocol = 3
		Case 'TSL1.1'
			lhc_Client.secureprotocol = 4
		Case 'TSL1.2'
			lhc_Client.secureprotocol = 5
		Case Else
			lhc_Client.secureprotocol = 0
	End Choose
Else
	lhc_Client.secureprotocol = 0
End If
//lhc_Client.SetRequestHeader ( "User-Agent", "Mozilla/5.0 (Windows NT 6.1; Trident/7.0; rv:11.0) like Gecko" )

ll_rtn = lhc_Client.sendrequest( ls_Method, ls_Url )

If ll_rtn = 1 Then
	ls_Respose = lhc_Client.Getresponseheaders( )
	ll_rtn = lhc_Client.GetResponsebody( ls_Body)
	If Len ( ls_body ) > 0 Then
		mle_1.Text = ls_Body
		Long 	start_pos
		start_pos = Pos(is_value, "~r~n:")
		DO WHILE start_pos > 0		
			 is_value = Replace(ls_Respose, start_pos, Len("~r~n:"), ":")
			start_pos = Pos(ls_Respose, "~r~n:", start_pos)						
		LOOP
		mle_1.Text += "~r~n~r~n" + ls_Respose
	End If
	ll_Code = lhc_Client.GetResponseStatusCode()
	st_code.Text = String ( ll_Code )
	ls_txt = lhc_Client.GetResponseStatusText()
	st_Text.Text = ls_txt
Else
	mle_1.Text = "Return:" + String ( ll_rtn ) 
End If
end event

type cb_1 from commandbutton within tabpage_1
integer x = 9
integer y = 188
integer width = 389
integer height = 100
integer taborder = 40
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "Get XML Test"
end type

event clicked;HttpClient 	lhc_Client
String 		ls_Url, ls_id, ls_Method, ls_Body, ls_Respose, ls_txt, ls_Error
Long 			ll_rtn, ll_Code

lhc_Client = Create HttpClient

st_code.Text = ""
st_Text.Text = ""
ls_Url = Trim ( sle_Url1.Text ) 
ls_Method = Trim ( sle_Method1.Text )

lhc_Client.timeout = 10
If rb_2.Checked Then
	Choose Case ddlb_1.Text
		Case "default"
			lhc_Client.secureprotocol = 0
		Case 'SSL2.0'
			lhc_Client.secureprotocol = 1
		Case 'SSL3.0'
			lhc_Client.secureprotocol = 2
		Case 'TSL1.0'
			lhc_Client.secureprotocol = 3
		Case 'TSL1.1'
			lhc_Client.secureprotocol = 4
		Case 'TSL1.2'
			lhc_Client.secureprotocol = 5
		Case Else
			lhc_Client.secureprotocol = 0
	End Choose
Else
	lhc_Client.secureprotocol = 0
End If

//lhc_Client.SetRequestHeader ( "Upgrade-Insecure-Requests", "1" )
lhc_Client.SetRequestHeader ( "Content-Type", "application/xml" )


ll_rtn = lhc_Client.sendrequest( ls_Method, ls_Url )

If ll_rtn = 1 Then
	ls_Respose = lhc_Client.Getresponseheaders( )
	ll_rtn = lhc_Client.GetResponsebody( ls_Body)
	If Len ( ls_body ) > 0 Then
		mle_1.Text = ls_Body + "~r~n~r~n" + ls_Respose
	End If
	ll_Code = lhc_Client.GetResponseStatusCode()
	st_code.Text = String ( ll_Code )
	ls_txt = lhc_Client.GetResponseStatusText()
	st_Text.Text = ls_txt
Else
	mle_1.Text = "Return:" + String ( ll_rtn ) 
End If
end event

type sle_method1 from singlelineedit within tabpage_1
integer x = 265
integer y = 104
integer width = 471
integer height = 80
integer taborder = 30
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string text = "GET"
borderstyle borderstyle = stylelowered!
end type

type st_3 from statictext within tabpage_1
integer x = 23
integer y = 116
integer width = 219
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Method:"
boolean focusrectangle = false
end type

type sle_url1 from singlelineedit within tabpage_1
integer x = 265
integer y = 16
integer width = 1906
integer height = 84
integer taborder = 20
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string text = "http://restapi.appeon.com:8099/springRest/api/jsonTest/listForMutiFormat/1.xml"
borderstyle borderstyle = stylelowered!
end type

type st_2 from statictext within tabpage_1
integer x = 23
integer y = 28
integer width = 137
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Url:"
boolean focusrectangle = false
end type

type mle_1 from multilineedit within tabpage_1
integer x = 23
integer y = 304
integer width = 3259
integer height = 820
integer taborder = 70
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean vscrollbar = true
borderstyle borderstyle = stylelowered!
end type

type tabpage_2 from userobject within tab_1
event create ( )
event destroy ( )
integer x = 18
integer y = 104
integer width = 3310
integer height = 1152
long backcolor = 67108864
string text = "GetProductList"
long tabtextcolor = 33554432
long picturemaskcolor = 536870912
st_19 st_19
ddlb_2 ddlb_2
rb_4 rb_4
rb_3 rb_3
cb_20 cb_20
mle_2 mle_2
cb_6 cb_6
sle_method2 sle_method2
st_5 st_5
sle_url2 sle_url2
st_1 st_1
end type

on tabpage_2.create
this.st_19=create st_19
this.ddlb_2=create ddlb_2
this.rb_4=create rb_4
this.rb_3=create rb_3
this.cb_20=create cb_20
this.mle_2=create mle_2
this.cb_6=create cb_6
this.sle_method2=create sle_method2
this.st_5=create st_5
this.sle_url2=create sle_url2
this.st_1=create st_1
this.Control[]={this.st_19,&
this.ddlb_2,&
this.rb_4,&
this.rb_3,&
this.cb_20,&
this.mle_2,&
this.cb_6,&
this.sle_method2,&
this.st_5,&
this.sle_url2,&
this.st_1}
end on

on tabpage_2.destroy
destroy(this.st_19)
destroy(this.ddlb_2)
destroy(this.rb_4)
destroy(this.rb_3)
destroy(this.cb_20)
destroy(this.mle_2)
destroy(this.cb_6)
destroy(this.sle_method2)
destroy(this.st_5)
destroy(this.sle_url2)
destroy(this.st_1)
end on

type st_19 from statictext within tabpage_2
integer x = 2528
integer y = 116
integer width = 608
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 16711680
long backcolor = 67108864
string text = "TSL1.1和TSL1.2会失败"
boolean focusrectangle = false
end type

type ddlb_2 from dropdownlistbox within tabpage_2
integer x = 2715
integer y = 16
integer width = 411
integer height = 452
integer taborder = 30
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean enabled = false
string item[] = {"default","SSL2.0","SSL3.0","TSL1.0","TSL1.1","TSL1.2"}
borderstyle borderstyle = stylelowered!
end type

event constructor;this.selectitem( 1)

end event

type rb_4 from radiobutton within tabpage_2
integer x = 2469
integer y = 20
integer width = 247
integer height = 72
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Https"
end type

event clicked;if rb_4.Checked Then
	rb_3.Checked = false
	sle_url2.Text = is_ip_https + "/springRest/api/jsonTest/listAll.json"
	ddlb_2.Enabled = true
End If
end event

type rb_3 from radiobutton within tabpage_2
integer x = 2226
integer y = 20
integer width = 238
integer height = 72
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Http"
boolean checked = true
end type

event clicked;if rb_3.Checked Then
	rb_4.Checked = false
	sle_url2.Text = is_ip + "/springRest/api/jsonTest/listAll.json"
	ddlb_2.Enabled = false
End If
end event

type cb_20 from commandbutton within tabpage_2
integer x = 549
integer y = 196
integer width = 773
integer height = 100
integer taborder = 60
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "Get Product List timeout 60s"
end type

event clicked;HttpClient 	lhc_Client
String 		ls_Url, ls_id, ls_Method, ls_Body, ls_Respose, ls_txt
Long 			ll_rtn, ll_cpu, ll_cpu2, ll_Code

lhc_Client = Create HttpClient

st_code.Text = ""
st_Text.Text = ""

//sle_Url2.Text = "http://192.0.2.195/restful/class"
ls_Url = Trim ( sle_Url2.Text ) 
ls_Method = Trim ( sle_Method2.Text )

lhc_Client.SetRequestHeader ( "Content-Type", "application/json;utf-8" )

//lhc_Client.timeout = 0
If rb_4.Checked Then
	Choose Case ddlb_2.Text
		Case "default"
			lhc_Client.secureprotocol = 0
		Case 'SSL2.0'
			lhc_Client.secureprotocol = 1
		Case 'SSL3.0'
			lhc_Client.secureprotocol = 2
		Case 'TSL1.0'
			lhc_Client.secureprotocol = 3
		Case 'TSL1.1'
			lhc_Client.secureprotocol = 4
		Case 'TSL1.2'
			lhc_Client.secureprotocol = 5
		Case Else
			lhc_Client.secureprotocol = 0
	End Choose
Else
	lhc_Client.secureprotocol = 0
End If

ll_cpu = cpu()
ll_rtn = lhc_Client.sendrequest( ls_Method, ls_Url )

If ll_rtn = 1 Then
	ls_Respose = lhc_Client.Getresponseheaders( )
	ll_rtn = lhc_Client.GetResponsebody( ls_Body)
	If Len ( ls_body ) > 0 Then
		ll_cpu2 = cpu() - ll_cpu
		mle_2.Text = ls_Respose + "~r~n " + String (Len ( ls_body )) + "~r~n 耗时:" + String ( ll_cpu2/60000 ) + "分钟"
	End If
	ll_Code = lhc_Client.GetResponseStatusCode()
	st_code.Text = String ( ll_Code )
	ls_txt = lhc_Client.GetResponseStatusText()
	st_Text.Text = ls_txt
Else
	ll_cpu2 = cpu() - ll_cpu
	ls_Respose = lhc_Client.Getresponseheaders( )
	mle_2.Text = ls_Respose + "~r~n " + String (Len ( ls_body )) + "~r~n 耗时:" + String ( ll_cpu2/60000 ) + "分钟"	
End If
end event

type mle_2 from multilineedit within tabpage_2
integer x = 23
integer y = 304
integer width = 3259
integer height = 820
integer taborder = 60
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean vscrollbar = true
borderstyle borderstyle = stylelowered!
end type

type cb_6 from commandbutton within tabpage_2
integer x = 9
integer y = 196
integer width = 453
integer height = 100
integer taborder = 50
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "Get Product List"
end type

event clicked;HttpClient 	lhc_Client
String 		ls_Url, ls_id, ls_Method, ls_Body, ls_Respose, ls_txt
Long 			ll_rtn, ll_cpu, ll_cpu2, ll_Code

lhc_Client = Create HttpClient

st_code.Text = ""
st_Text.Text = ""

//sle_Url2.Text = "http://192.0.2.195/restful/class"
ls_Url = Trim ( sle_Url2.Text ) 
ls_Method = Trim ( sle_Method2.Text )

lhc_Client.SetRequestHeader ( "Content-Type", "application/json;utf-8" )


lhc_Client.timeout = 0

If rb_4.Checked Then
	Choose Case ddlb_2.Text
		Case "default"
			lhc_Client.secureprotocol = 0
		Case 'SSL2.0'
			lhc_Client.secureprotocol = 1
		Case 'SSL3.0'
			lhc_Client.secureprotocol = 2
		Case 'TSL1.0'
			lhc_Client.secureprotocol = 3
		Case 'TSL1.1'
			lhc_Client.secureprotocol = 4
		Case 'TSL1.2'
			lhc_Client.secureprotocol = 5
		Case Else
			lhc_Client.secureprotocol = 0
	End Choose
Else
	lhc_Client.secureprotocol = 0
End If

ll_cpu = cpu()
ll_rtn = lhc_Client.sendrequest( ls_Method, ls_Url )

If ll_rtn = 1 Then
	ls_Respose = lhc_Client.Getresponseheaders( )
	ll_rtn = lhc_Client.GetResponsebody( ls_Body)
	If Len ( ls_body ) > 0 Then
		ll_cpu2 = cpu() - ll_cpu
		mle_2.Text = ls_Body + "~r~n~r~n" + ls_Respose + "~r~n " + String (Len ( ls_body )) + "~r~n 耗时:" + String ( ll_cpu2/60000 ) + "分钟"
		
//		//写文件
//		long ll_exp		
//		ll_exp = fileopen("arrayall.txt",textmode!,write!,shared!,replace!,encodingutf8!)
//		filewriteex(ll_exp,ls_body )		
//		fileclose(ll_exp)
		
	End If
	ll_Code = lhc_Client.GetResponseStatusCode()
	st_code.Text = String ( ll_Code )
	ls_txt = lhc_Client.GetResponseStatusText()
	st_Text.Text = ls_txt
Else
	ll_cpu2 = cpu() - ll_cpu
	mle_2.Text = " 耗时:" + String ( ll_cpu2/60000 )  + "~r~nReturn:" + String ( ll_rtn )
End If
end event

type sle_method2 from singlelineedit within tabpage_2
integer x = 265
integer y = 104
integer width = 471
integer height = 80
integer taborder = 40
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string text = "GET"
borderstyle borderstyle = stylelowered!
end type

type st_5 from statictext within tabpage_2
integer x = 23
integer y = 116
integer width = 219
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Method:"
boolean focusrectangle = false
end type

type sle_url2 from singlelineedit within tabpage_2
integer x = 265
integer y = 16
integer width = 1906
integer height = 84
integer taborder = 60
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string text = "http://restapi.appeon.com:8099/springRest/api/jsonTest/listAll.json"
borderstyle borderstyle = stylelowered!
end type

type st_1 from statictext within tabpage_2
integer x = 23
integer y = 28
integer width = 137
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Url:"
boolean focusrectangle = false
end type

type tabpage_3 from userobject within tab_1
event create ( )
event destroy ( )
integer x = 18
integer y = 104
integer width = 3310
integer height = 1152
long backcolor = 67108864
string text = "GetProduct"
long tabtextcolor = 33554432
long picturemaskcolor = 536870912
st_20 st_20
ddlb_3 ddlb_3
rb_6 rb_6
rb_5 rb_5
st_10 st_10
sle_productid sle_productid
st_8 st_8
st_7 st_7
sle_url3 sle_url3
sle_method3 sle_method3
mle_3 mle_3
cb_8 cb_8
end type

on tabpage_3.create
this.st_20=create st_20
this.ddlb_3=create ddlb_3
this.rb_6=create rb_6
this.rb_5=create rb_5
this.st_10=create st_10
this.sle_productid=create sle_productid
this.st_8=create st_8
this.st_7=create st_7
this.sle_url3=create sle_url3
this.sle_method3=create sle_method3
this.mle_3=create mle_3
this.cb_8=create cb_8
this.Control[]={this.st_20,&
this.ddlb_3,&
this.rb_6,&
this.rb_5,&
this.st_10,&
this.sle_productid,&
this.st_8,&
this.st_7,&
this.sle_url3,&
this.sle_method3,&
this.mle_3,&
this.cb_8}
end on

on tabpage_3.destroy
destroy(this.st_20)
destroy(this.ddlb_3)
destroy(this.rb_6)
destroy(this.rb_5)
destroy(this.st_10)
destroy(this.sle_productid)
destroy(this.st_8)
destroy(this.st_7)
destroy(this.sle_url3)
destroy(this.sle_method3)
destroy(this.mle_3)
destroy(this.cb_8)
end on

type st_20 from statictext within tabpage_3
integer x = 2528
integer y = 116
integer width = 608
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 16711680
long backcolor = 67108864
string text = "TSL1.1和TSL1.2会失败"
boolean focusrectangle = false
end type

type ddlb_3 from dropdownlistbox within tabpage_3
integer x = 2715
integer y = 16
integer width = 411
integer height = 452
integer taborder = 30
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean enabled = false
string item[] = {"default","SSL2.0","SSL3.0","TSL1.0","TSL1.1","TSL1.2"}
borderstyle borderstyle = stylelowered!
end type

event constructor;this.selectitem( 1)

end event

type rb_6 from radiobutton within tabpage_3
integer x = 2469
integer y = 20
integer width = 247
integer height = 72
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Https"
end type

event clicked;if rb_6.Checked Then
	rb_5.Checked = false
	sle_url3.Text = is_ip_https + "/springRest/api/jsonTest/findById/"
	ddlb_3.Enabled = true
End If
end event

type rb_5 from radiobutton within tabpage_3
integer x = 2226
integer y = 20
integer width = 238
integer height = 72
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Http"
boolean checked = true
end type

event clicked;if rb_5.Checked Then
	rb_6.Checked = false
	sle_url3.Text = is_ip + "/springRest/api/jsonTest/findById/"
	ddlb_3.Enabled = false
End If
end event

type st_10 from statictext within tabpage_3
integer x = 14
integer y = 200
integer width = 279
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "ProductID:"
boolean focusrectangle = false
end type

type sle_productid from singlelineedit within tabpage_3
integer x = 302
integer y = 188
integer width = 379
integer height = 84
integer taborder = 60
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string text = "1"
borderstyle borderstyle = stylelowered!
end type

type st_8 from statictext within tabpage_3
integer x = 23
integer y = 116
integer width = 219
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Method:"
boolean focusrectangle = false
end type

type st_7 from statictext within tabpage_3
integer x = 23
integer y = 28
integer width = 137
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Url:"
boolean focusrectangle = false
end type

type sle_url3 from singlelineedit within tabpage_3
integer x = 265
integer y = 16
integer width = 1906
integer height = 84
integer taborder = 10
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string text = "http://restapi.appeon.com:8099/springRest/api/jsonTest/findById/"
borderstyle borderstyle = stylelowered!
end type

type sle_method3 from singlelineedit within tabpage_3
integer x = 265
integer y = 104
integer width = 471
integer height = 80
integer taborder = 50
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string text = "GET"
borderstyle borderstyle = stylelowered!
end type

type mle_3 from multilineedit within tabpage_3
integer x = 23
integer y = 304
integer width = 3259
integer height = 820
integer taborder = 60
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean vscrollbar = true
borderstyle borderstyle = stylelowered!
end type

type cb_8 from commandbutton within tabpage_3
integer x = 713
integer y = 180
integer width = 453
integer height = 100
integer taborder = 60
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "Get Product"
end type

event clicked;HttpClient 	lhc_Client
String 		ls_Url, ls_id, ls_Method, ls_Body, ls_Respose, ls_txt
Long 			ll_rtn, ll_Code

lhc_Client = Create HttpClient

st_code.Text = ""
st_Text.Text = ""

ls_Url = Trim ( sle_Url3.Text )  + sle_productid.Text 
ls_Method = Trim ( sle_Method3.Text )

lhc_Client.SetRequestHeader ( "Content-Type", "application/json" )

lhc_Client.TimeOut = 10
If rb_6.Checked Then
	Choose Case ddlb_3.Text
		Case "default"
			lhc_Client.secureprotocol = 0
		Case 'SSL2.0'
			lhc_Client.secureprotocol = 1
		Case 'SSL3.0'
			lhc_Client.secureprotocol = 2
		Case 'TSL1.0'
			lhc_Client.secureprotocol = 3
		Case 'TSL1.1'
			lhc_Client.secureprotocol = 4
		Case 'TSL1.2'
			lhc_Client.secureprotocol = 5
		Case Else
			lhc_Client.secureprotocol = 0
	End Choose
Else
	lhc_Client.secureprotocol = 0
End If

ll_rtn = lhc_Client.sendrequest( ls_Method, ls_Url )

If ll_rtn = 1 Then
	ls_Respose = lhc_Client.Getresponseheaders( )
	ll_rtn = lhc_Client.GetResponsebody( ls_Body)
	If Len ( ls_body ) > 0 Then
		mle_3.Text = ls_Body + "~r~n~r~n" + ls_Respose
	End If
	ll_Code = lhc_Client.GetResponseStatusCode()
	st_code.Text = String ( ll_Code )
	ls_txt = lhc_Client.GetResponseStatusText()
	st_Text.Text = ls_txt
Else
	mle_3.Text = "Return:" + String ( ll_rtn ) 
End If

end event

type tabpage_4 from userobject within tab_1
integer x = 18
integer y = 104
integer width = 3310
integer height = 1152
long backcolor = 67108864
string text = "Edit Product"
long tabtextcolor = 33554432
long picturemaskcolor = 536870912
st_26 st_26
ddlb_4 ddlb_4
rb_8 rb_8
rb_7 rb_7
sle_productid4 sle_productid4
mle_4 mle_4
cb_9 cb_9
st_14 st_14
sle_method4 sle_method4
st_12 st_12
st_11 st_11
sle_url4 sle_url4
end type

on tabpage_4.create
this.st_26=create st_26
this.ddlb_4=create ddlb_4
this.rb_8=create rb_8
this.rb_7=create rb_7
this.sle_productid4=create sle_productid4
this.mle_4=create mle_4
this.cb_9=create cb_9
this.st_14=create st_14
this.sle_method4=create sle_method4
this.st_12=create st_12
this.st_11=create st_11
this.sle_url4=create sle_url4
this.Control[]={this.st_26,&
this.ddlb_4,&
this.rb_8,&
this.rb_7,&
this.sle_productid4,&
this.mle_4,&
this.cb_9,&
this.st_14,&
this.sle_method4,&
this.st_12,&
this.st_11,&
this.sle_url4}
end on

on tabpage_4.destroy
destroy(this.st_26)
destroy(this.ddlb_4)
destroy(this.rb_8)
destroy(this.rb_7)
destroy(this.sle_productid4)
destroy(this.mle_4)
destroy(this.cb_9)
destroy(this.st_14)
destroy(this.sle_method4)
destroy(this.st_12)
destroy(this.st_11)
destroy(this.sle_url4)
end on

type st_26 from statictext within tabpage_4
integer x = 2528
integer y = 116
integer width = 608
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 16711680
long backcolor = 67108864
string text = "TSL1.1和TSL1.2会失败"
boolean focusrectangle = false
end type

type ddlb_4 from dropdownlistbox within tabpage_4
integer x = 2715
integer y = 16
integer width = 411
integer height = 452
integer taborder = 30
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean enabled = false
string item[] = {"default","SSL2.0","SSL3.0","TSL1.0","TSL1.1","TSL1.2"}
borderstyle borderstyle = stylelowered!
end type

event constructor;this.selectitem( 1)

end event

type rb_8 from radiobutton within tabpage_4
integer x = 2469
integer y = 20
integer width = 247
integer height = 72
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Https"
end type

event clicked;if rb_8.Checked Then
	rb_7.Checked = false
	sle_url4.Text = is_ip_https + "/springRest/api/jsonTest/add"
	ddlb_4.Enabled = true
End If
end event

type rb_7 from radiobutton within tabpage_4
integer x = 2226
integer y = 20
integer width = 238
integer height = 72
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Http"
boolean checked = true
end type

event clicked;if rb_7.Checked Then
	rb_8.Checked = false
	sle_url4.Text = is_ip + "/springRest/api/jsonTest/add"
	ddlb_4.Enabled = false
End If
end event

type sle_productid4 from multilineedit within tabpage_4
integer x = 274
integer y = 184
integer width = 1490
integer height = 152
integer taborder = 70
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean vscrollbar = true
borderstyle borderstyle = stylelowered!
end type

type mle_4 from multilineedit within tabpage_4
integer x = 23
integer y = 304
integer width = 3259
integer height = 820
integer taborder = 60
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean vscrollbar = true
borderstyle borderstyle = stylelowered!
end type

type cb_9 from commandbutton within tabpage_4
integer x = 1792
integer y = 180
integer width = 453
integer height = 100
integer taborder = 50
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "Edit Product"
end type

event clicked;HttpClient 	lhc_Client
String 		ls_Url, ls_id, ls_Method, ls_Body, ls_Respose, ls_txt, ls_PostData
Long 			ll_rtn, ll_Count, ll_Code

lhc_Client = Create HttpClient

st_code.Text = ""
st_Text.Text = ""

//{"id":1,"purchaseOrder":"ABERDE01","line":"1","item":"2307-004970","itemType":"Consigned","itemDescription":"SILICONE, CLEAR RTV","qtyOrdered":"24.0000000000","unitOfPurchase":"EACH      ","unitCost":"4.6300000000","dueDate":"2007-10-12 00:00:00.0","dateCompleted":"2007-10-09 00:00:00.0","manufacturerPartNo":"14073","reqStr":null,"charset":null}
ls_Url = Trim ( sle_Url4.Text )  
ls_PostData = sle_productid4.Text// 'id=1&purchaseOrder=ABERDE01&line=1&item=2307-004970&itemType=Consigned&itemDescription=SILICONEedit2&qtyOrdered=24.0000000000&unitOfPurchase=EACH&unitCost=4.6300000000&dueDate=2007-10-12%2000%3A00%3A00.0&dateCompleted=2007-10-09%2000%3A00%3A00.0&manufacturerPartNo=14073'

ls_Method = Trim ( sle_Method4.Text )

lhc_Client.SetRequestHeader ( "Content-Type", "application/x-www-form-urlencoded;application/json" )

lhc_Client.TimeOut = 10
If rb_8.Checked Then
	Choose Case ddlb_4.Text
		Case "default"
			lhc_Client.secureprotocol = 0
		Case 'SSL2.0'
			lhc_Client.secureprotocol = 1
		Case 'SSL3.0'
			lhc_Client.secureprotocol = 2
		Case 'TSL1.0'
			lhc_Client.secureprotocol = 3
		Case 'TSL1.1'
			lhc_Client.secureprotocol = 4
		Case 'TSL1.2'
			lhc_Client.secureprotocol = 5
		Case Else
			lhc_Client.secureprotocol = 0
	End Choose
Else
	lhc_Client.secureprotocol = 0
End If

ll_rtn = lhc_Client.sendrequest( ls_Method, ls_Url, ls_PostData )

If ll_rtn = 1 Then
	ls_Respose = lhc_Client.Getresponseheaders( )
	ll_rtn = lhc_Client.GetResponsebody( ls_Body)
	If Len ( ls_body ) > 0 Then
		mle_4.Text = ls_Body + "~r~n~r~n" + ls_Respose
	End If
	ll_Code = lhc_Client.GetResponseStatusCode()
	st_code.Text = String ( ll_Code )
	ls_txt = lhc_Client.GetResponseStatusText()
	st_Text.Text = ls_txt
Else
	mle_4.Text = "Return:" + String ( ll_rtn ) 
End If
end event

type st_14 from statictext within tabpage_4
integer x = 14
integer y = 200
integer width = 274
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Product:"
boolean focusrectangle = false
end type

type sle_method4 from singlelineedit within tabpage_4
integer x = 265
integer y = 104
integer width = 471
integer height = 80
integer taborder = 50
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string text = "POST"
borderstyle borderstyle = stylelowered!
end type

type st_12 from statictext within tabpage_4
integer x = 23
integer y = 116
integer width = 219
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Method:"
boolean focusrectangle = false
end type

type st_11 from statictext within tabpage_4
integer x = 23
integer y = 28
integer width = 137
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Url:"
boolean focusrectangle = false
end type

type sle_url4 from singlelineedit within tabpage_4
integer x = 265
integer y = 16
integer width = 1906
integer height = 84
integer taborder = 10
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string text = "http://restapi.appeon.com:8099/springRest/api/jsonTest/add"
borderstyle borderstyle = stylelowered!
end type

type tabpage_5 from userobject within tab_1
integer x = 18
integer y = 104
integer width = 3310
integer height = 1152
long backcolor = 67108864
string text = "DeleteProduct"
long tabtextcolor = 33554432
long picturemaskcolor = 536870912
st_27 st_27
ddlb_5 ddlb_5
rb_10 rb_10
rb_9 rb_9
mle_5 mle_5
cb_10 cb_10
sle_productid5 sle_productid5
st_18 st_18
sle_method5 sle_method5
st_16 st_16
st_15 st_15
sle_url5 sle_url5
end type

on tabpage_5.create
this.st_27=create st_27
this.ddlb_5=create ddlb_5
this.rb_10=create rb_10
this.rb_9=create rb_9
this.mle_5=create mle_5
this.cb_10=create cb_10
this.sle_productid5=create sle_productid5
this.st_18=create st_18
this.sle_method5=create sle_method5
this.st_16=create st_16
this.st_15=create st_15
this.sle_url5=create sle_url5
this.Control[]={this.st_27,&
this.ddlb_5,&
this.rb_10,&
this.rb_9,&
this.mle_5,&
this.cb_10,&
this.sle_productid5,&
this.st_18,&
this.sle_method5,&
this.st_16,&
this.st_15,&
this.sle_url5}
end on

on tabpage_5.destroy
destroy(this.st_27)
destroy(this.ddlb_5)
destroy(this.rb_10)
destroy(this.rb_9)
destroy(this.mle_5)
destroy(this.cb_10)
destroy(this.sle_productid5)
destroy(this.st_18)
destroy(this.sle_method5)
destroy(this.st_16)
destroy(this.st_15)
destroy(this.sle_url5)
end on

type st_27 from statictext within tabpage_5
integer x = 2528
integer y = 116
integer width = 608
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 16711680
long backcolor = 67108864
string text = "TSL1.1和TSL1.2会失败"
boolean focusrectangle = false
end type

type ddlb_5 from dropdownlistbox within tabpage_5
integer x = 2715
integer y = 16
integer width = 411
integer height = 452
integer taborder = 30
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean enabled = false
string item[] = {"default","SSL2.0","SSL3.0","TSL1.0","TSL1.1","TSL1.2"}
borderstyle borderstyle = stylelowered!
end type

event constructor;this.selectitem( 1)

end event

type rb_10 from radiobutton within tabpage_5
integer x = 2469
integer y = 20
integer width = 247
integer height = 72
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Https"
end type

event clicked;if rb_10.Checked Then
	rb_9.Checked = false
	sle_url5.Text = is_ip_https + "/springRest/api/jsonTest/delete/"
	ddlb_5.Enabled = true
End If
end event

type rb_9 from radiobutton within tabpage_5
integer x = 2226
integer y = 20
integer width = 238
integer height = 72
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Http"
boolean checked = true
end type

event clicked;if rb_9.Checked Then
	rb_10.Checked = false
	sle_url5.Text = is_ip + "/springRest/api/jsonTest/delete/"
	ddlb_5.Enabled = false
End If
end event

type mle_5 from multilineedit within tabpage_5
integer x = 23
integer y = 304
integer width = 3259
integer height = 820
integer taborder = 60
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean vscrollbar = true
borderstyle borderstyle = stylelowered!
end type

type cb_10 from commandbutton within tabpage_5
integer x = 713
integer y = 180
integer width = 453
integer height = 100
integer taborder = 50
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "Delete Product"
end type

event clicked;HttpClient 	lhc_Client
String 		ls_Url, ls_id, ls_Method, ls_Body, ls_Respose, ls_txt
Long 			ll_rtn, ll_Code

lhc_Client = Create HttpClient

st_code.Text = ""
st_Text.Text = ""

ls_Url = Trim ( sle_Url5.Text )  + sle_productid5.Text
ls_Method = Trim ( sle_Method5.Text )

lhc_Client.SetRequestHeader ( "Content-Type", "application/json" )

lhc_Client.TimeOut = 10
If rb_10.Checked Then
	Choose Case ddlb_5.Text
		Case "default"
			lhc_Client.secureprotocol = 0
		Case 'SSL2.0'
			lhc_Client.secureprotocol = 1
		Case 'SSL3.0'
			lhc_Client.secureprotocol = 2
		Case 'TSL1.0'
			lhc_Client.secureprotocol = 3
		Case 'TSL1.1'
			lhc_Client.secureprotocol = 4
		Case 'TSL1.2'
			lhc_Client.secureprotocol = 5
		Case Else
			lhc_Client.secureprotocol = 0
	End Choose
Else
	lhc_Client.secureprotocol = 0
End If

ll_rtn = lhc_Client.sendrequest( ls_Method, ls_Url )
If ll_rtn = 1 Then
	ls_Respose = lhc_Client.Getresponseheaders( )
	ll_rtn = lhc_Client.GetResponsebody( ls_Body)
	If Len ( ls_body ) > 0 Then
		mle_5.Text = ls_Body + "~r~n~r~n" + ls_Respose
	End If
	ll_Code = lhc_Client.GetResponseStatusCode()
	st_code.Text = String ( ll_Code )
	ls_txt = lhc_Client.GetResponseStatusText()
	st_Text.Text = ls_txt
Else
	mle_5.Text = "Return:" + String ( ll_rtn ) 
End If
end event

type sle_productid5 from singlelineedit within tabpage_5
integer x = 302
integer y = 188
integer width = 379
integer height = 84
integer taborder = 50
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string text = "2"
borderstyle borderstyle = stylelowered!
end type

type st_18 from statictext within tabpage_5
integer x = 14
integer y = 200
integer width = 274
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "ProductId:"
boolean focusrectangle = false
end type

type sle_method5 from singlelineedit within tabpage_5
integer x = 265
integer y = 104
integer width = 471
integer height = 80
integer taborder = 50
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string text = "DELETE"
borderstyle borderstyle = stylelowered!
end type

type st_16 from statictext within tabpage_5
integer x = 23
integer y = 116
integer width = 219
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Method:"
boolean focusrectangle = false
end type

type st_15 from statictext within tabpage_5
integer x = 23
integer y = 28
integer width = 137
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Url:"
boolean focusrectangle = false
end type

type sle_url5 from singlelineedit within tabpage_5
integer x = 265
integer y = 16
integer width = 1906
integer height = 84
integer taborder = 10
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string text = "http://restapi.appeon.com:8099/springRest/api/jsonTest/delete/"
borderstyle borderstyle = stylelowered!
end type

type tabpage_7 from userobject within tab_1
event create ( )
event destroy ( )
integer x = 18
integer y = 104
integer width = 3310
integer height = 1152
long backcolor = 67108864
string text = "Add Product"
long tabtextcolor = 33554432
long picturemaskcolor = 536870912
st_29 st_29
ddlb_6 ddlb_6
rb_12 rb_12
rb_11 rb_11
sle_productid7 sle_productid7
mle_7 mle_7
cb_13 cb_13
st_9 st_9
sle_method7 sle_method7
st_6 st_6
sle_url7 sle_url7
st_4 st_4
end type

on tabpage_7.create
this.st_29=create st_29
this.ddlb_6=create ddlb_6
this.rb_12=create rb_12
this.rb_11=create rb_11
this.sle_productid7=create sle_productid7
this.mle_7=create mle_7
this.cb_13=create cb_13
this.st_9=create st_9
this.sle_method7=create sle_method7
this.st_6=create st_6
this.sle_url7=create sle_url7
this.st_4=create st_4
this.Control[]={this.st_29,&
this.ddlb_6,&
this.rb_12,&
this.rb_11,&
this.sle_productid7,&
this.mle_7,&
this.cb_13,&
this.st_9,&
this.sle_method7,&
this.st_6,&
this.sle_url7,&
this.st_4}
end on

on tabpage_7.destroy
destroy(this.st_29)
destroy(this.ddlb_6)
destroy(this.rb_12)
destroy(this.rb_11)
destroy(this.sle_productid7)
destroy(this.mle_7)
destroy(this.cb_13)
destroy(this.st_9)
destroy(this.sle_method7)
destroy(this.st_6)
destroy(this.sle_url7)
destroy(this.st_4)
end on

type st_29 from statictext within tabpage_7
integer x = 2528
integer y = 116
integer width = 608
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 16711680
long backcolor = 67108864
string text = "TSL1.1和TSL1.2会失败"
boolean focusrectangle = false
end type

type ddlb_6 from dropdownlistbox within tabpage_7
integer x = 2715
integer y = 16
integer width = 411
integer height = 452
integer taborder = 30
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean enabled = false
string item[] = {"default","SSL2.0","SSL3.0","TSL1.0","TSL1.1","TSL1.2"}
borderstyle borderstyle = stylelowered!
end type

event constructor;this.selectitem( 1)

end event

type rb_12 from radiobutton within tabpage_7
integer x = 2469
integer y = 20
integer width = 247
integer height = 72
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Https"
end type

event clicked;if rb_12.Checked Then
	rb_11.Checked = false
	sle_url7.Text = is_ip_https + "/springRest/api/jsonTest/add"
	ddlb_6.Enabled = true
End If
end event

type rb_11 from radiobutton within tabpage_7
integer x = 2226
integer y = 20
integer width = 238
integer height = 72
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Http"
boolean checked = true
end type

event clicked;if rb_11.Checked Then
	rb_12.Checked = false
	sle_url7.Text = is_ip + "/springRest/api/jsonTest/add"
	ddlb_6.Enabled = false
End If
end event

type sle_productid7 from multilineedit within tabpage_7
integer x = 274
integer y = 188
integer width = 1490
integer height = 152
integer taborder = 80
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean vscrollbar = true
borderstyle borderstyle = stylelowered!
end type

type mle_7 from multilineedit within tabpage_7
integer x = 23
integer y = 304
integer width = 3259
integer height = 820
integer taborder = 80
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean vscrollbar = true
borderstyle borderstyle = stylelowered!
end type

type cb_13 from commandbutton within tabpage_7
integer x = 1792
integer y = 180
integer width = 453
integer height = 100
integer taborder = 70
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "Add Product"
end type

event clicked;HttpClient 	lhc_Client
String 		ls_Url, ls_id, ls_Method, ls_Body, ls_Respose, ls_txt, ls_PostData
Long 			ll_rtn, ll_Count, ll_Code

lhc_Client = Create HttpClient

st_code.Text = ""
st_Text.Text = ""

//{"id":,"purchaseOrder":"ABERDE01","line":"1","item":"2307-004970","itemType":"Consigned","itemDescription":"SILICONE, CLEAR RTV","qtyOrdered":"24.0000000000","unitOfPurchase":"EACH      ","unitCost":"4.6300000000","dueDate":"2007-10-12 00:00:00.0","dateCompleted":"2007-10-09 00:00:00.0","manufacturerPartNo":"14073","reqStr":null,"charset":null}
ls_Url = Trim ( sle_Url7.Text )  
ls_PostData = sle_productid7.Text// 'id=&purchaseOrder=ABERDE01&line=1&item=2307-004970&itemType=Consigned&itemDescription=SILICONEedit2&qtyOrdered=24.0000000000&unitOfPurchase=EACH&unitCost=4.6300000000&dueDate=2007-10-12%2000%3A00%3A00.0&dateCompleted=2007-10-09%2000%3A00%3A00.0&manufacturerPartNo=14073'

ls_Method = Trim ( sle_Method7.Text )

lhc_Client.SetRequestHeader ( "Content-Type", "application/x-www-form-urlencoded;application/json" )

lhc_Client.TimeOut = 10
If rb_12.Checked Then
	Choose Case ddlb_6.Text
		Case "default"
			lhc_Client.secureprotocol = 0
		Case 'SSL2.0'
			lhc_Client.secureprotocol = 1
		Case 'SSL3.0'
			lhc_Client.secureprotocol = 2
		Case 'TSL1.0'
			lhc_Client.secureprotocol = 3
		Case 'TSL1.1'
			lhc_Client.secureprotocol = 4
		Case 'TSL1.2'
			lhc_Client.secureprotocol = 5
		Case Else
			lhc_Client.secureprotocol = 0
	End Choose
Else
	lhc_Client.secureprotocol = 0
End If

ll_rtn = lhc_Client.sendrequest( ls_Method, ls_Url, ls_PostData )

If ll_rtn = 1 Then
	ls_Respose = lhc_Client.Getresponseheaders( )
	ll_rtn = lhc_Client.GetResponsebody( ls_Body)
	If Len ( ls_body ) > 0 Then
		mle_7.Text = ls_Body + "~r~n~r~n" + ls_Respose
	End If
	ll_Code = lhc_Client.GetResponseStatusCode()
	st_code.Text = String ( ll_Code )
	ls_txt = lhc_Client.GetResponseStatusText()
	st_Text.Text = ls_txt
Else
	mle_7.Text = "Return:" + String ( ll_rtn ) 
End If
end event

type st_9 from statictext within tabpage_7
integer x = 14
integer y = 200
integer width = 274
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Product:"
boolean focusrectangle = false
end type

type sle_method7 from singlelineedit within tabpage_7
integer x = 265
integer y = 104
integer width = 471
integer height = 80
integer taborder = 50
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string text = "POST"
borderstyle borderstyle = stylelowered!
end type

type st_6 from statictext within tabpage_7
integer x = 23
integer y = 116
integer width = 219
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Method:"
boolean focusrectangle = false
end type

type sle_url7 from singlelineedit within tabpage_7
integer x = 265
integer y = 16
integer width = 1906
integer height = 84
integer taborder = 10
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string text = "http://restapi.appeon.com:8099/springRest/api/jsonTest/add"
borderstyle borderstyle = stylelowered!
end type

type st_4 from statictext within tabpage_7
integer x = 23
integer y = 28
integer width = 137
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Url:"
boolean focusrectangle = false
end type

type tabpage_8 from userobject within tab_1
event create ( )
event destroy ( )
integer x = 18
integer y = 104
integer width = 3310
integer height = 1152
long backcolor = 67108864
string text = "GetPage"
long tabtextcolor = 33554432
long picturemaskcolor = 536870912
st_31 st_31
ddlb_7 ddlb_7
rb_14 rb_14
rb_13 rb_13
cb_4 cb_4
mle_8 mle_8
cb_3 cb_3
sle_productid8 sle_productid8
st_21 st_21
sle_method8 sle_method8
st_17 st_17
sle_url8 sle_url8
st_13 st_13
end type

on tabpage_8.create
this.st_31=create st_31
this.ddlb_7=create ddlb_7
this.rb_14=create rb_14
this.rb_13=create rb_13
this.cb_4=create cb_4
this.mle_8=create mle_8
this.cb_3=create cb_3
this.sle_productid8=create sle_productid8
this.st_21=create st_21
this.sle_method8=create sle_method8
this.st_17=create st_17
this.sle_url8=create sle_url8
this.st_13=create st_13
this.Control[]={this.st_31,&
this.ddlb_7,&
this.rb_14,&
this.rb_13,&
this.cb_4,&
this.mle_8,&
this.cb_3,&
this.sle_productid8,&
this.st_21,&
this.sle_method8,&
this.st_17,&
this.sle_url8,&
this.st_13}
end on

on tabpage_8.destroy
destroy(this.st_31)
destroy(this.ddlb_7)
destroy(this.rb_14)
destroy(this.rb_13)
destroy(this.cb_4)
destroy(this.mle_8)
destroy(this.cb_3)
destroy(this.sle_productid8)
destroy(this.st_21)
destroy(this.sle_method8)
destroy(this.st_17)
destroy(this.sle_url8)
destroy(this.st_13)
end on

type st_31 from statictext within tabpage_8
integer x = 2528
integer y = 116
integer width = 608
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 16711680
long backcolor = 67108864
string text = "TSL1.1和TSL1.2会失败"
boolean focusrectangle = false
end type

type ddlb_7 from dropdownlistbox within tabpage_8
integer x = 2715
integer y = 16
integer width = 411
integer height = 452
integer taborder = 30
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean enabled = false
string item[] = {"default","SSL2.0","SSL3.0","TSL1.0","TSL1.1","TSL1.2"}
borderstyle borderstyle = stylelowered!
end type

event constructor;this.selectitem( 1)

end event

type rb_14 from radiobutton within tabpage_8
integer x = 2469
integer y = 20
integer width = 247
integer height = 72
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Https"
end type

event clicked;if rb_14.Checked Then
	rb_13.Checked = false
	sle_url8.Text = is_ip_https + "/springRest/api/jsonTest/listForMutiFormat/"
	ddlb_7.Enabled = true
End If
end event

type rb_13 from radiobutton within tabpage_8
integer x = 2226
integer y = 20
integer width = 238
integer height = 72
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Http"
boolean checked = true
end type

event clicked;if rb_13.Checked Then
	rb_14.Checked = false
	sle_url8.Text = is_ip + "/springRest/api/jsonTest/listForMutiFormat/"
	ddlb_7.Enabled = false
End If
end event

type cb_4 from commandbutton within tabpage_8
integer x = 1321
integer y = 180
integer width = 453
integer height = 100
integer taborder = 70
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "Get Page XML"
end type

event clicked;HttpClient 	lhc_Client
String 		ls_Url, ls_id, ls_Method, ls_Body, ls_Respose, ls_txt
Long 			ll_rtn, ll_Code

lhc_Client = Create HttpClient

st_code.Text = ""
st_Text.Text = ""

ls_Url = Trim ( sle_Url8.Text )  + sle_productid8.Text + ".xml"
ls_Method = Trim ( sle_Method8.Text )

lhc_Client.SetRequestHeader ( "Content-Type", "application/xml" )

lhc_Client.TimeOut = 10
If rb_14.Checked Then
	Choose Case ddlb_7.Text
		Case "default"
			lhc_Client.secureprotocol = 0
		Case 'SSL2.0'
			lhc_Client.secureprotocol = 1
		Case 'SSL3.0'
			lhc_Client.secureprotocol = 2
		Case 'TSL1.0'
			lhc_Client.secureprotocol = 3
		Case 'TSL1.1'
			lhc_Client.secureprotocol = 4
		Case 'TSL1.2'
			lhc_Client.secureprotocol = 5
		Case Else
			lhc_Client.secureprotocol = 0
	End Choose
Else
	lhc_Client.secureprotocol = 0
End If

ll_rtn = lhc_Client.sendrequest( ls_Method, ls_Url )
If ll_rtn = 1 Then
	ls_Respose = lhc_Client.Getresponseheaders( )
	ll_rtn = lhc_Client.GetResponsebody( ls_Body)
	If Len ( ls_body ) > 0 Then
		mle_8.Text = ls_Body + "~r~n~r~n" + ls_Respose
	End If
	ll_Code = lhc_Client.GetResponseStatusCode()
	st_code.Text = String ( ll_Code )
	ls_txt = lhc_Client.GetResponseStatusText()
	st_Text.Text = ls_txt
Else
	mle_8.Text = "Return:" + String ( ll_rtn ) 
End If
end event

type mle_8 from multilineedit within tabpage_8
integer x = 23
integer y = 304
integer width = 3259
integer height = 820
integer taborder = 80
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean vscrollbar = true
borderstyle borderstyle = stylelowered!
end type

type cb_3 from commandbutton within tabpage_8
integer x = 782
integer y = 180
integer width = 453
integer height = 100
integer taborder = 70
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "Get Page JSON"
end type

event clicked;HttpClient 	lhc_Client
String 		ls_Url, ls_id, ls_Method, ls_Body, ls_Respose, ls_txt
Long 			ll_rtn, ll_Code

lhc_Client = Create HttpClient

st_code.Text = ""
st_Text.Text = ""

ls_Url = Trim ( sle_Url8.Text )  + sle_productid8.Text + ".json"
ls_Method = Trim ( sle_Method8.Text )

lhc_Client.SetRequestHeader ( "Content-Type", "application/json" )

lhc_Client.TimeOut = 10
If rb_14.Checked Then
	Choose Case ddlb_7.Text
		Case "default"
			lhc_Client.secureprotocol = 0
		Case 'SSL2.0'
			lhc_Client.secureprotocol = 1
		Case 'SSL3.0'
			lhc_Client.secureprotocol = 2
		Case 'TSL1.0'
			lhc_Client.secureprotocol = 3
		Case 'TSL1.1'
			lhc_Client.secureprotocol = 4
		Case 'TSL1.2'
			lhc_Client.secureprotocol = 5
		Case Else
			lhc_Client.secureprotocol = 0
	End Choose
Else
	lhc_Client.secureprotocol = 0
End If

ll_rtn = lhc_Client.sendrequest( ls_Method, ls_Url )

If ll_rtn = 1 Then
	ls_Respose = lhc_Client.Getresponseheaders( )
	ll_rtn = lhc_Client.GetResponsebody( ls_Body)
	If Len ( ls_body ) > 0 Then
		mle_8.Text = ls_Body + "~r~n~r~n" + ls_Respose
	End If
	ll_Code = lhc_Client.GetResponseStatusCode()
	st_code.Text = String ( ll_Code )
	ls_txt = lhc_Client.GetResponseStatusText()
	st_Text.Text = ls_txt
Else
	mle_8.Text = "Return:" + String ( ll_rtn ) 
End If

end event

type sle_productid8 from singlelineedit within tabpage_8
integer x = 265
integer y = 188
integer width = 471
integer height = 84
integer taborder = 60
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string text = "1"
borderstyle borderstyle = stylelowered!
end type

type st_21 from statictext within tabpage_8
integer x = 14
integer y = 200
integer width = 229
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Page:"
boolean focusrectangle = false
end type

type sle_method8 from singlelineedit within tabpage_8
integer x = 265
integer y = 104
integer width = 471
integer height = 80
integer taborder = 50
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string text = "GET"
borderstyle borderstyle = stylelowered!
end type

type st_17 from statictext within tabpage_8
integer x = 23
integer y = 116
integer width = 219
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Method:"
boolean focusrectangle = false
end type

type sle_url8 from singlelineedit within tabpage_8
integer x = 265
integer y = 16
integer width = 1906
integer height = 84
integer taborder = 10
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string text = "http://restapi.appeon.com:8099/springRest/api/jsonTest/listForMutiFormat/"
borderstyle borderstyle = stylelowered!
end type

type st_13 from statictext within tabpage_8
integer x = 23
integer y = 28
integer width = 137
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Url:"
boolean focusrectangle = false
end type

type tabpage_9 from userobject within tab_1
integer x = 18
integer y = 104
integer width = 3310
integer height = 1152
long backcolor = 67108864
string text = "Test Encode"
long tabtextcolor = 33554432
long picturemaskcolor = 536870912
st_32 st_32
ddlb_8 ddlb_8
rb_16 rb_16
rb_15 rb_15
cb_19 cb_19
cb_18 cb_18
cb_14 cb_14
cb_7 cb_7
mle_9 mle_9
cb_5 cb_5
sle_method9 sle_method9
st_23 st_23
sle_url9 sle_url9
st_22 st_22
end type

on tabpage_9.create
this.st_32=create st_32
this.ddlb_8=create ddlb_8
this.rb_16=create rb_16
this.rb_15=create rb_15
this.cb_19=create cb_19
this.cb_18=create cb_18
this.cb_14=create cb_14
this.cb_7=create cb_7
this.mle_9=create mle_9
this.cb_5=create cb_5
this.sle_method9=create sle_method9
this.st_23=create st_23
this.sle_url9=create sle_url9
this.st_22=create st_22
this.Control[]={this.st_32,&
this.ddlb_8,&
this.rb_16,&
this.rb_15,&
this.cb_19,&
this.cb_18,&
this.cb_14,&
this.cb_7,&
this.mle_9,&
this.cb_5,&
this.sle_method9,&
this.st_23,&
this.sle_url9,&
this.st_22}
end on

on tabpage_9.destroy
destroy(this.st_32)
destroy(this.ddlb_8)
destroy(this.rb_16)
destroy(this.rb_15)
destroy(this.cb_19)
destroy(this.cb_18)
destroy(this.cb_14)
destroy(this.cb_7)
destroy(this.mle_9)
destroy(this.cb_5)
destroy(this.sle_method9)
destroy(this.st_23)
destroy(this.sle_url9)
destroy(this.st_22)
end on

type st_32 from statictext within tabpage_9
integer x = 2528
integer y = 116
integer width = 608
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 16711680
long backcolor = 67108864
string text = "TSL1.1和TSL1.2会失败"
boolean focusrectangle = false
end type

type ddlb_8 from dropdownlistbox within tabpage_9
integer x = 2715
integer y = 16
integer width = 411
integer height = 452
integer taborder = 30
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean enabled = false
string item[] = {"default","SSL2.0","SSL3.0","TSL1.0","TSL1.1","TSL1.2"}
borderstyle borderstyle = stylelowered!
end type

event constructor;this.selectitem( 1)

end event

type rb_16 from radiobutton within tabpage_9
integer x = 2469
integer y = 20
integer width = 247
integer height = 72
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Https"
end type

event clicked;if rb_16.Checked Then
	rb_15.Checked = false
	sle_url9.Text = is_ip_https + "/springRest/api/jsonTest/testEncode"
	ddlb_8.Enabled = true
End If
end event

type rb_15 from radiobutton within tabpage_9
integer x = 2226
integer y = 20
integer width = 238
integer height = 72
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Http"
boolean checked = true
end type

event clicked;if rb_15.Checked Then
	rb_16.Checked = false
	sle_url9.Text = is_ip + "/springRest/api/jsonTest/testEncode"
	ddlb_8.Enabled = false
End If
end event

type cb_19 from commandbutton within tabpage_9
integer x = 1970
integer y = 192
integer width = 453
integer height = 100
integer taborder = 60
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
boolean enabled = false
string text = "Post UTF16be"
end type

event clicked;HttpClient 	lhc_Client
String 		ls_Url, ls_id, ls_Method, ls_Body, ls_Respose, ls_txt, ls_postdata,ls_reqStr
Long 			ll_rtn, ll_Code

lhc_Client = Create HttpClient

st_code.Text = ""
st_Text.Text = ""

ls_Url = Trim ( sle_Url9.Text ) 
ls_Method = Trim ( sle_Method9.Text )
ls_reqStr = "reqStr=" + String ( Blob ("多编码测试", EncodingUTF16BE!)) + "&charset=utf-8"
ls_postdata = ls_reqStr
lhc_Client.SetRequestHeader ( "Content-Type", "application/x-www-form-urlencoded;application/json;" )
lhc_Client.SetRequestHeader ( "Pragma", "no-cache" )
lhc_Client.TimeOut = 10

If rb_16.Checked Then
	Choose Case ddlb_8.Text
		Case "default"
			lhc_Client.secureprotocol = 0
		Case 'SSL2.0'
			lhc_Client.secureprotocol = 1
		Case 'SSL3.0'
			lhc_Client.secureprotocol = 2
		Case 'TSL1.0'
			lhc_Client.secureprotocol = 3
		Case 'TSL1.1'
			lhc_Client.secureprotocol = 4
		Case 'TSL1.2'
			lhc_Client.secureprotocol = 5
		Case Else
			lhc_Client.secureprotocol = 0
	End Choose
Else
	lhc_Client.secureprotocol = 0
End If

ll_rtn = lhc_Client.sendrequest( ls_Method, ls_Url, ls_postdata, EncodingUTF16BE! )

If ll_rtn = 1 Then
	ls_Respose = lhc_Client.Getresponseheaders( )
	ll_rtn = lhc_Client.GetResponsebody( ls_Body, EncodingUTF16BE!)
	If Len ( ls_body ) > 0 Then
		mle_9.Text = ls_Body
	End If
	mle_9.Text += "~r~n" + String ( ls_Respose )
	ll_Code = lhc_Client.GetResponseStatusCode()
	st_code.Text = String ( ll_Code )
	ls_txt = lhc_Client.GetResponseStatusText()
	st_Text.Text = ls_txt
Else
	mle_9.Text = "Return:" + String ( ll_rtn ) 
End If
end event

type cb_18 from commandbutton within tabpage_9
integer x = 1509
integer y = 192
integer width = 453
integer height = 100
integer taborder = 60
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
boolean enabled = false
string text = "Post UTF16le"
end type

event clicked;HttpClient 	lhc_Client
String 		ls_Url, ls_id, ls_Method, ls_Body, ls_Respose, ls_txt, ls_postdata, ls_reqStr
Long 			ll_rtn, ll_Code

lhc_Client = Create HttpClient

st_code.Text = ""
st_Text.Text = ""

ls_Url = Trim ( sle_Url9.Text ) 
ls_Method = Trim ( sle_Method9.Text )
ls_reqStr = "reqStr=" + String ( Blob ("多编码测试", EncodingUTF16LE!)) + "&charset=utf-8"
ls_postdata = ls_reqStr

lhc_Client.SetRequestHeader ( "Content-Type", "application/x-www-form-urlencoded;application/json;" )
lhc_Client.SetRequestHeader ( "Pragma", "no-cache" )
lhc_Client.TimeOut = 10

If rb_16.Checked Then
	Choose Case ddlb_8.Text
		Case "default"
			lhc_Client.secureprotocol = 0
		Case 'SSL2.0'
			lhc_Client.secureprotocol = 1
		Case 'SSL3.0'
			lhc_Client.secureprotocol = 2
		Case 'TSL1.0'
			lhc_Client.secureprotocol = 3
		Case 'TSL1.1'
			lhc_Client.secureprotocol = 4
		Case 'TSL1.2'
			lhc_Client.secureprotocol = 5
		Case Else
			lhc_Client.secureprotocol = 0
	End Choose
Else
	lhc_Client.secureprotocol = 0
End If

ll_rtn = lhc_Client.sendrequest( ls_Method, ls_Url, ls_postdata, EncodingUTF16LE! )

If ll_rtn = 1 Then
	ls_Respose = lhc_Client.Getresponseheaders( )
	ll_rtn = lhc_Client.GetResponsebody( ls_Body,EncodingUTF16LE!)
	If Len ( ls_body ) > 0 Then
		mle_9.Text = ls_Body
	End If
	mle_9.Text += "~r~n" + String ( ls_Respose )
	ll_Code = lhc_Client.GetResponseStatusCode()
	st_code.Text = String ( ll_Code )
	ls_txt = lhc_Client.GetResponseStatusText()
	st_Text.Text = ls_txt
Else
	mle_9.Text = "Return:" + String ( ll_rtn ) 
End If
end event

type cb_14 from commandbutton within tabpage_9
integer x = 1033
integer y = 192
integer width = 453
integer height = 100
integer taborder = 60
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
boolean enabled = false
string text = "Post gbk"
end type

event clicked;HttpClient 	lhc_Client
String 		ls_Url, ls_id, ls_Method, ls_Body, ls_Respose, ls_txt, ls_postdata,ls_reqStr
Long 			ll_rtn, ll_Code

lhc_Client = Create HttpClient

st_code.Text = ""
st_Text.Text = ""

ls_Url = Trim ( sle_Url9.Text ) 
ls_Method = Trim ( sle_Method9.Text )

ls_reqStr = "reqStr=" + String ( Blob ("多编码测试", EncodingANSI!)) + "&charset=utf-8"
ls_postdata = ls_reqStr
lhc_Client.SetRequestHeader ( "Content-Type", "application/x-www-form-urlencoded;application/json;" )
lhc_Client.SetRequestHeader ( "Pragma", "no-cache" )
lhc_Client.TimeOut = 10

If rb_16.Checked Then
	Choose Case ddlb_8.Text
		Case "default"
			lhc_Client.secureprotocol = 0
		Case 'SSL2.0'
			lhc_Client.secureprotocol = 1
		Case 'SSL3.0'
			lhc_Client.secureprotocol = 2
		Case 'TSL1.0'
			lhc_Client.secureprotocol = 3
		Case 'TSL1.1'
			lhc_Client.secureprotocol = 4
		Case 'TSL1.2'
			lhc_Client.secureprotocol = 5
		Case Else
			lhc_Client.secureprotocol = 0
	End Choose
Else
	lhc_Client.secureprotocol = 0
End If

ll_rtn = lhc_Client.sendrequest( ls_Method, ls_Url, ls_postdata, EncodingANSI! )

If ll_rtn = 1 Then
	ls_Respose = lhc_Client.Getresponseheaders( )
	ll_rtn = lhc_Client.GetResponsebody( ls_Body,EncodingANSI!)
	If Len ( ls_body ) > 0 Then
		mle_9.Text = ls_Body
	End If
	mle_9.Text += "~r~n" + String ( ls_Respose )
	ll_Code = lhc_Client.GetResponseStatusCode()
	st_code.Text = String ( ll_Code )
	ls_txt = lhc_Client.GetResponseStatusText()
	st_Text.Text = ls_txt
Else
	mle_9.Text = "Return:" + String ( ll_rtn ) 
End If
end event

type cb_7 from commandbutton within tabpage_9
integer x = 517
integer y = 192
integer width = 453
integer height = 100
integer taborder = 80
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
boolean enabled = false
string text = "Post UTF8"
end type

event clicked;HttpClient 	lhc_Client
String 		ls_Url, ls_id, ls_Method, ls_Body, ls_Respose, ls_txt, ls_postdata, ls_reqStr
Long 			ll_rtn, ll_Code

lhc_Client = Create HttpClient

st_code.Text = ""
st_Text.Text = ""

ls_Url = Trim ( sle_Url9.Text ) 
ls_Method = Trim ( sle_Method9.Text )
ls_reqStr = "reqStr=" + String ( Blob ("多编码测试", EncodingUTF8!)) + "&charset=utf-8"
ls_postdata = ls_reqStr
lhc_Client.SetRequestHeader ( "Content-Type", "application/x-www-form-urlencoded;application/json;" )
lhc_Client.SetRequestHeader ( "Pragma", "no-cache" )
lhc_Client.TimeOut = 10

If rb_16.Checked Then
	Choose Case ddlb_8.Text
		Case "default"
			lhc_Client.secureprotocol = 0
		Case 'SSL2.0'
			lhc_Client.secureprotocol = 1
		Case 'SSL3.0'
			lhc_Client.secureprotocol = 2
		Case 'TSL1.0'
			lhc_Client.secureprotocol = 3
		Case 'TSL1.1'
			lhc_Client.secureprotocol = 4
		Case 'TSL1.2'
			lhc_Client.secureprotocol = 5
		Case Else
			lhc_Client.secureprotocol = 0
	End Choose
Else
	lhc_Client.secureprotocol = 0
End If

ll_rtn = lhc_Client.sendrequest( ls_Method, ls_Url, ls_postdata, EncodingUTF8! )

If ll_rtn = 1 Then
	ls_Respose = lhc_Client.Getresponseheaders( )
	ll_rtn = lhc_Client.GetResponsebody( ls_Body,EncodingUTF8!)
	If Len ( ls_body ) > 0 Then
		mle_9.Text = ls_Body
	End If
	mle_9.Text += "~r~n" + String ( ls_Respose )
	ll_Code = lhc_Client.GetResponseStatusCode()
	st_code.Text = String ( ll_Code )
	ls_txt = lhc_Client.GetResponseStatusText()
	st_Text.Text = ls_txt
Else
	mle_9.Text = "Return:" + String ( ll_rtn ) 
End If
end event

type mle_9 from multilineedit within tabpage_9
integer x = 23
integer y = 304
integer width = 3259
integer height = 820
integer taborder = 80
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean vscrollbar = true
borderstyle borderstyle = stylelowered!
end type

type cb_5 from commandbutton within tabpage_9
integer x = 41
integer y = 192
integer width = 411
integer height = 100
integer taborder = 70
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "Post Default"
end type

event clicked;HttpClient 	lhc_Client
String 		ls_Url, ls_id, ls_Method, ls_Body, ls_Respose, ls_txt, ls_postdata
Long 			ll_rtn, ll_Code

lhc_Client = Create HttpClient

st_code.Text = ""
st_Text.Text = ""

ls_Url = Trim ( sle_Url9.Text ) 
ls_Method = Trim ( sle_Method9.Text )
ls_postdata = "reqStr=多编码测试&charset=utf-8"
lhc_Client.SetRequestHeader ( "Content-Type", "application/x-www-form-urlencoded;application/json;" )

lhc_Client.TimeOut = 10
If rb_16.Checked Then
	Choose Case ddlb_8.Text
		Case "default"
			lhc_Client.secureprotocol = 0
		Case 'SSL2.0'
			lhc_Client.secureprotocol = 1
		Case 'SSL3.0'
			lhc_Client.secureprotocol = 2
		Case 'TSL1.0'
			lhc_Client.secureprotocol = 3
		Case 'TSL1.1'
			lhc_Client.secureprotocol = 4
		Case 'TSL1.2'
			lhc_Client.secureprotocol = 5
		Case Else
			lhc_Client.secureprotocol = 0
	End Choose
Else
	lhc_Client.secureprotocol = 0
End If

ll_rtn = lhc_Client.sendrequest( ls_Method, ls_Url, ls_postdata )
If ll_rtn = 1 Then
	ls_Respose = lhc_Client.Getresponseheaders( )
	ll_rtn = lhc_Client.GetResponsebody( ls_Body)
	If Len ( ls_body ) > 0 Then
		mle_9.Text = ls_Body
	End If
	mle_9.Text += "~r~n" + String ( ls_Respose )
	ll_Code = lhc_Client.GetResponseStatusCode()
	st_code.Text = String ( ll_Code )
	ls_txt = lhc_Client.GetResponseStatusText()
	st_Text.Text = ls_txt
Else
	mle_9.Text = "Return:" + String ( ll_rtn ) 
End If
end event

type sle_method9 from singlelineedit within tabpage_9
integer x = 265
integer y = 104
integer width = 471
integer height = 80
integer taborder = 50
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string text = "POST"
borderstyle borderstyle = stylelowered!
end type

type st_23 from statictext within tabpage_9
integer x = 23
integer y = 116
integer width = 219
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Method:"
boolean focusrectangle = false
end type

type sle_url9 from singlelineedit within tabpage_9
integer x = 265
integer y = 16
integer width = 1906
integer height = 84
integer taborder = 10
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string text = "http://restapi.appeon.com:8099/springRest/api/jsonTest/testEncode"
borderstyle borderstyle = stylelowered!
end type

type st_22 from statictext within tabpage_9
integer x = 23
integer y = 28
integer width = 137
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Url:"
boolean focusrectangle = false
end type

type tabpage_10 from userobject within tab_1
event create ( )
event destroy ( )
integer x = 18
integer y = 104
integer width = 3310
integer height = 1152
long backcolor = 67108864
string text = "UploadFile"
long tabtextcolor = 33554432
long picturemaskcolor = 536870912
st_33 st_33
ddlb_9 ddlb_9
rb_18 rb_18
rb_17 rb_17
mle_10 mle_10
cb_22 cb_22
sle_file sle_file
cb_21 cb_21
sle_filepath sle_filepath
st_30 st_30
sle_method10 sle_method10
st_25 st_25
sle_url10 sle_url10
st_24 st_24
end type

on tabpage_10.create
this.st_33=create st_33
this.ddlb_9=create ddlb_9
this.rb_18=create rb_18
this.rb_17=create rb_17
this.mle_10=create mle_10
this.cb_22=create cb_22
this.sle_file=create sle_file
this.cb_21=create cb_21
this.sle_filepath=create sle_filepath
this.st_30=create st_30
this.sle_method10=create sle_method10
this.st_25=create st_25
this.sle_url10=create sle_url10
this.st_24=create st_24
this.Control[]={this.st_33,&
this.ddlb_9,&
this.rb_18,&
this.rb_17,&
this.mle_10,&
this.cb_22,&
this.sle_file,&
this.cb_21,&
this.sle_filepath,&
this.st_30,&
this.sle_method10,&
this.st_25,&
this.sle_url10,&
this.st_24}
end on

on tabpage_10.destroy
destroy(this.st_33)
destroy(this.ddlb_9)
destroy(this.rb_18)
destroy(this.rb_17)
destroy(this.mle_10)
destroy(this.cb_22)
destroy(this.sle_file)
destroy(this.cb_21)
destroy(this.sle_filepath)
destroy(this.st_30)
destroy(this.sle_method10)
destroy(this.st_25)
destroy(this.sle_url10)
destroy(this.st_24)
end on

type st_33 from statictext within tabpage_10
integer x = 2528
integer y = 116
integer width = 608
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 16711680
long backcolor = 67108864
string text = "TSL1.1和TSL1.2会失败"
boolean focusrectangle = false
end type

type ddlb_9 from dropdownlistbox within tabpage_10
integer x = 2715
integer y = 16
integer width = 411
integer height = 452
integer taborder = 30
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean enabled = false
string item[] = {"default","SSL2.0","SSL3.0","TSL1.0","TSL1.1","TSL1.2"}
borderstyle borderstyle = stylelowered!
end type

event constructor;this.selectitem( 1)

end event

type rb_18 from radiobutton within tabpage_10
integer x = 2469
integer y = 20
integer width = 247
integer height = 72
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Https"
end type

event clicked;if rb_18.Checked Then
	rb_17.Checked = false
	sle_url10.Text = is_ip_https + "/springRest/api/fileOperate/uploadFile"
	ddlb_9.Enabled = true
End If
end event

type rb_17 from radiobutton within tabpage_10
integer x = 2226
integer y = 20
integer width = 238
integer height = 72
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Http"
boolean checked = true
end type

event clicked;if rb_17.Checked Then
	rb_18.Checked = false
	sle_url10.Text = is_ip + "/springRest/api/fileOperate/uploadFile"
	ddlb_9.Enabled = false
End If
end event

type mle_10 from multilineedit within tabpage_10
integer x = 23
integer y = 304
integer width = 3259
integer height = 820
integer taborder = 80
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean hscrollbar = true
boolean vscrollbar = true
borderstyle borderstyle = stylelowered!
end type

type cb_22 from commandbutton within tabpage_10
integer x = 27
integer y = 192
integer width = 453
integer height = 100
integer taborder = 80
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "Upload File"
end type

event clicked;HttpClient 	lhc_Client
String 		ls_Url, ls_id, ls_Method, ls_Body, ls_Respose, ls_txt, ls_Error,ls_header, ls_end
String 		ls_postdata, ls_file, ls_FileID, ls_FilePath
Blob 			lb_FileData, b
Long 			ll_rtn, ll_num, flen, loops, new_pos,i, bytes_read, ll_Code


lhc_Client = Create HttpClient
//lhc_Client.TimeOut = 0

st_code.Text = ""
st_Text.Text = ""

ls_Url = Trim ( sle_Url10.Text ) 
ls_Method = Trim ( sle_Method10.Text )
ls_file = sle_file.Text
If IsNull ( ls_File ) Or Trim ( ls_File ) = "" Then
	MessageBox ( "Tip", "Not selected file!" )
	Return 
End If

ls_FilePath = sle_filepath.Text

If not fileexists(ls_FilePath) Then
	messagebox('提示','请选择或输入一个文件名！',StopSign!)	
	return
End If

flen = FileLength(ls_FilePath)
If flen = 0 Then
	messagebox('提示','文件长度为0！',StopSign!)	
	return
End If
ll_Num = FileOpen(ls_FilePath, &
        StreamMode!, Read!, LockRead!)
If ll_Num = -1 Then
	messagebox('提示','打开文件失败！',StopSign!)
	return
End If
//st_start.text = string(now(),'hh:mm:ss:fff')

If flen > 32765 Then
	If Mod(flen, 32765) = 0 Then
		loops = flen/32765
	ELSE
		loops = (flen/32765) + 1
	End If
ELSE
	loops = 1
End If
new_pos = 1
FOR i = 1 to loops
	bytes_read = FileRead(ll_Num, b)
	lb_FileData = lb_FileData + b
NEXT
FileClose(ll_Num)


ls_postdata = "file=" + String ( lb_FileData )


lhc_Client.SetRequestHeader ( "Content-Type", "multipart/form-data; boundary=--------------------------359875084413580694217125" )
//lhc_Client.SetRequestHeader ( "accept-encoding", "gzip, deflate" )
//lhc_Client.SetRequestHeader ( "cache-control", "no-cache" )
lhc_Client.SetRequestHeader ( "Connection", "keep-alive" )

//下面的-符合个数比header多2个，且文件尾再多2个
ls_header = "----------------------------359875084413580694217125" + "~r~n" + & 
	'Content-Disposition: form-data; name="file"; filename="'+ ls_file +'"' + "~r~n" + &
	'Content-Type: image/jpeg' + "~r~n~r~n"
ls_End = "~r~n" + "----------------------------359875084413580694217125--"
lb_FileData = Blob (ls_header,EncodingUTF8!) + lb_FileData + Blob (ls_End,EncodingUTF8!)

If rb_18.Checked Then
	Choose Case ddlb_9.Text
		Case "default"
			lhc_Client.secureprotocol = 0
		Case 'SSL2.0'
			lhc_Client.secureprotocol = 1
		Case 'SSL3.0'
			lhc_Client.secureprotocol = 2
		Case 'TSL1.0'
			lhc_Client.secureprotocol = 3
		Case 'TSL1.1'
			lhc_Client.secureprotocol = 4
		Case 'TSL1.2'
			lhc_Client.secureprotocol = 5
		Case Else
			lhc_Client.secureprotocol = 0
	End Choose
End If


ll_rtn = lhc_Client.sEndrequest( ls_Method, ls_Url, lb_FileData )

If ll_rtn = 1 Then
	ls_Respose = lhc_Client.Getresponseheaders( )
	ll_rtn = lhc_Client.GetResponsebody( ls_Body)
	If Len ( ls_body ) > 0 Then
		mle_10.Text = ls_Body + "~r~n~r~n" + ls_Respose
	End If
	ll_Code = lhc_Client.GetResponseStatusCode()
	st_code.Text = String ( ll_Code )
	ls_txt = lhc_Client.GetResponseStatusText()
	st_Text.Text = ls_txt
Else
	mle_10.Text = "Return:" + String ( ll_rtn ) 
End If


If IsValid ( lhc_Client ) Then DesTroy ( lhc_Client )


end event

type sle_file from singlelineedit within tabpage_10
integer x = 1614
integer y = 112
integer width = 421
integer height = 68
integer taborder = 60
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean enabled = false
borderstyle borderstyle = stylelowered!
end type

type cb_21 from commandbutton within tabpage_10
integer x = 2039
integer y = 96
integer width = 293
integer height = 100
integer taborder = 60
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
string text = "Browse"
end type

event clicked;String 	ls_path, ls_file
Long 		ll_return

ll_return = getfileopenname("Select Json File",ls_path,ls_file,"*.*","All File(*.*),*.*")

If ll_Return > 0 Then
	sle_filepath.Text = ls_path
	sle_file.Text = ls_file
End IF
end event

type sle_filepath from singlelineedit within tabpage_10
integer x = 923
integer y = 112
integer width = 686
integer height = 68
integer taborder = 50
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
boolean enabled = false
borderstyle borderstyle = stylelowered!
end type

type st_30 from statictext within tabpage_10
integer x = 759
integer y = 116
integer width = 151
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "File:"
boolean focusrectangle = false
end type

type sle_method10 from singlelineedit within tabpage_10
integer x = 265
integer y = 104
integer width = 471
integer height = 80
integer taborder = 50
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string text = "POST"
borderstyle borderstyle = stylelowered!
end type

type st_25 from statictext within tabpage_10
integer x = 23
integer y = 116
integer width = 219
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Method:"
boolean focusrectangle = false
end type

type sle_url10 from singlelineedit within tabpage_10
integer x = 265
integer y = 16
integer width = 1906
integer height = 84
integer taborder = 10
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
string text = "http://restapi.appeon.com:8099/springRest/api/fileOperate/uploadFile"
borderstyle borderstyle = stylelowered!
end type

type st_24 from statictext within tabpage_10
integer x = 23
integer y = 28
integer width = 137
integer height = 56
integer textsize = -9
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Tahoma"
long textcolor = 33554432
long backcolor = 67108864
string text = "Url:"
boolean focusrectangle = false
end type

